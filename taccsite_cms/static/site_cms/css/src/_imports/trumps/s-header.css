/*
Header

Styles for elements within a header.

Warning: There are complex overwrites for 3rd-party and subsite code:

- Bootstrap
  (for CMS navigation)
  (for Portal navigation)
- a subset of Bootstrap 3.3.7
  (for CMS body content, can affect navigation)
- Docs
- Portal

Portal & Docs Selectors:

- To select old markup by using subsite-specific selectors, some styles target Portal or Docs. This was necessary because markup changed in CMS during GH-101, but Portal and Docs markup was not updated. If Portal and Docs markup matches that of CMS, then these selectors need not be so specific for _this_ purpose.
- To overwrite Bootstrap by using extra-specific selectors, some styles target Portal or Docs. This was necessary because Bootstrap on both subsites load _after_ these styles (thus took precedence). If we load Bootstrap styles before CMS styles, then these selectors need not be so specific for _this_ purpose.

Markup: s-header.html.twig

Styleguide Trumps.Scopes.Header
*/
@import url("_imports/tools/selectors.css");
@import url("_imports/tools/x-arrow.css");
@import url("_imports/tools/x-truncate.css");
@import url("_imports/tools/x-mobile-button.css");

/* RFE: Make Portal & Docs markup match CMS (see "Portal & Docs Selectors") */
/* RFE: Load Bootstrap before CMS stylesheets (see "Portal & Docs Selectors") */





/*
 * GENERAL
 */





/* Container */

/* To match CMS line-height (see `body`) */
:--for-docs .s-header,
:--for-portal .s-header {
  line-height: 1.4;
}





/* Variables */

/* FAQ: These have `--header` prefix because they can be used outside header */
@media (--nav-expanded) {
  :root {
    --header-brandbar-height: env(--header-brandbar-normal-height);
    --header-navbar-height: env(--header-navbar-normal-height);

    --portal-navlink-max-width: none;
  }
}
@media (--nav-compressed) {
  :root {
    --header-brandbar-height: env(--header-brandbar-mobile-height);
    --header-navbar-height: env(--header-navbar-mobile-height);
  }

  @media (--nav-narrow-and-above) {
    :root {
      --portal-navlink-max-width: env(--portal-navlink-normal-max-width);
    }
  }
  @media (--nav-narrow-and-below) {
    :root {
      --portal-navlink-max-width: env(--portal-navlink-mobile-max-width);
    }
  }
}





/*
 * BRANDING & LOGO
 */





/* Branding */

.s-header.c-branding,
/* To apply style to old markup (see "Portal & Docs Selectors") */
/* NOTE: The old markup is dynamically replaced by new markup from CMS */
:--for-docs .branding-header,
:--for-portal .branding-header {
  /* To prevent zero-height element as it is loaded */
  height: var(--header-brandbar-height);

  color: var(--global-color-primary--xx-light);
  background-color: var(--global-color-primary--xx-dark);
  border-bottom: 1px solid var(--global-color-primary--xx-light);
}





/* Logo */

#header-logo {
  /* To allow projects to change value and responsive design to use value */
  --space-after-logo-before-nav: 25px;

  display: flex;
  align-items: center;

  /* To overwrite Bootstrap */
  margin-right: var(--space-after-logo-before-nav);

  /* To align logo (whole image not just visible pixels) with Portal content */
  margin-left: env(--header-navbar-left-pad);

  /* FAQ: In case image does not load and browser shows alt text */
  color: env(--header-text-color);
}
/* To overwrite Bootstrap */
#header-logo.navbar-brand {
  padding-top: unset;
  padding-bottom: unset;
}

#header-logo .c-logo__image {
  padding-top: 5px;
  padding-bottom: 5px;

  /* Of base i.e. container */
  /* To avoid a project shrinking logo beyond legibility */
  min-height: 50%;
  min-width: 50%;
}



/* Logo: Mobile */

/* To manage logo width influence on other elements */
@media (--nav-expanded) {
  #header-logo {
    /* To prevent zero-width element as it is loaded */
    /* To align position of first CMS nav link with Portal section headers */
    /* CAVEAT: Only works on narrow-enough logos */
    min-width: calc(190px - var(--space-after-logo-before-nav));
  }
}



/* Logo: Desktop */

@media (--nav-compressed) {
  #header-logo {
    /* To prevent wide image from forcing `.navbar-toggler` to be wrapped */
    max-width: calc(188px - var(--space-after-logo-before-nav));
  }
}





/*
 * NAVIGATION
 */





/* Navbar */



/* Navbar: Selectors */

@custom-selector :--nav-bar-fake-bkgd  .s-header.navbar::after;



/* Navbar: General */

.s-header.navbar {
  font-size: 12px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  font-weight: env(--bold);
  font-family: env(--header-font-family);

  /* Copied from Portal (via `body`) */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* To color navbar, but allow CMS nav to be transluscent to body content */
:--nav-bar-fake-bkgd {
  content: '';

  position: absolute;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;

  background-color: env(--header-bkgd-color);
}

/* To overwrite Bootstrap */
.s-header.navbar,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header.navbar,
:--for-portal .s-header.navbar {
  padding: 0;
}

/* To stretch elements as tall as parent */
.s-header.navbar,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header.navbar,
:--for-portal .s-header.navbar,
/* To propogate styles through extra wrapper (of Bootstrap-driven mobile nav) */
.s-header .navbar-collapse {
  align-items: stretch;
}



/* Navbar: Dimensions for Descendants */

/* To prevent zero-height element as it is loaded */
/* FAQ: The zero-height fix is most obvious on Portal/Docs or slow network */
/* To prevent extra height from FOUC during Portal/Docs AJAX content load */
/* To set nav height, but not constrain height of opened mobile nav */
/* FAQ: Set height of descendants, but not of CMS and Portal and mobile navs */
:--nav-bar-fake-bkgd,
#header-logo,
.s-header :--navbar-button,
.s-header .s-search-bar {
  height: var(--header-navbar-height);
}

/* To support shrinking and truncation of certain nav elements */
/* SEE: https://css-tricks.com/flexbox-truncated-text/ */
.s-header .navbar-collapse,
  #header-logo,
  .s-header .s-cms-nav,
  .s-header .s-search-bar { min-width: 0; }







/* Navbar Toggle   (Mobile-Only) */



/* Navbar Toggle: Selectors */

@custom-selector :--navbar-button
  .navbar-toggler;
@custom-selector :--navbar-button--opened
  .navbar-toggler[aria-expanded="true"];
@custom-selector :--navbar-button--closed
  .navbar-toggler[aria-expanded="false"];



/* Navbar Toggle: Mobile */

@media (--nav-compressed) {

  /* Layout */

  /* To layout the toggle as a "mobile button" */
  .s-header :--navbar-button--opened,
  .s-header :--navbar-button--closed {
    /* WARNING: Do not set `display` outside of (--nav-compressed) */
    /* FAQ: The button as Bootstrap `.navbar-toggler` uses `display: none` */
    display: grid;
  }
  .s-header :--navbar-button--opened { @extend %x-mobile-button--only-icon; }
  .s-header :--navbar-button--closed { @extend %x-mobile-button--no-toggle; }
  .s-header :--navbar-button::after  { @extend %x-mobile-button__text; }
  .s-header :--navbar-button::before { @extend %x-mobile-button__icon; }



  /* Button */

  .s-header :--navbar-button {
    width: env(--header-navbar-toggle-width);
    margin-right: env(--header-navbar-right-pad);
    padding: 0; /* to overwrite Bootstrap */

    background-color: env(--header-portal-nav-bkgd-color);

    /* To overwrite Bootstrap */
    border: none;
    border-radius: 0;
  }

  /* To isolate styles that require more specificity to override Portal */
  .s-header :--navbar-button,
  /* To overwrite Bootstrap (see "Portal & Docs Selectors") */
  :--for-docs .s-header :--navbar-button,
  :--for-portal .s-header :--navbar-button {
    color: env(--header-text-color);
  }

  .s-header :--navbar-button:hover,
  .s-header :--navbar-button:active {
    background-color: env(--header-link-bkgd-color);
  }



  /* Icon */

  /* To overwrite Bootstrap */
  .s-header .navbar-toggler-icon { display: none; }
  /* To swap Bootstrap icon for Cortal icon */
  /* HACK: To apply icon styles without using a class in the markup */
  /* FAQ: For dynamic markup change, Portal & Docs markup must be updated */
  /* SEE: https://getbootstrap.com/docs/4.0/components/collapse/#events */
  .s-header :--navbar-button { @extend [class*=" icon-"]; }
  .s-header :--navbar-button::before { @extend .icon; }
  /* To change icon without using dynamic icon classes */
  .s-header :--navbar-button--opened { @extend .icon-close; }
  .s-header :--navbar-button--closed { @extend .icon-burger; }
  /* To stretch icon to mimic icon in design (which is not available yet) */
  .s-header :--navbar-button--closed::before { transform: scaleX(1.5); }
  /* To overwrite `.icon` */
  .s-header :--navbar-button::before {
    font-size: 30px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  }



  /* Text */

  .s-header :--navbar-button::after {
    content: attr(data-icon-label);
  }
  .s-header :--navbar-button--opened::after { display: none; }
  /* To apply style to old markup (see "Portal & Docs Selectors") */
  /* FAQ: This selector does not use `:--for-portal` but has similar purpose */
  .s-header :--navbar-button:not([data-icon-label])::after {
    content: 'Menu';
  }

}





/* Navbar Collapsible   (Mobile-Only) */



/* Navbar Collapsible: Mobile */

@media (--nav-compressed) {

  /* Style */

  .s-header .navbar-collapse {
    background-color: rgba(var(--global-color-primary--x-dark-rgb), 0.6);
    backdrop-filter: blur(18px) brightness(85%);

    border: env(--border-width--normal) solid var(--global-color-primary--dark);
  }



  /* Layout */

  /* HACK: To transform the navbar into a dropdown */
  /* TODO: We should either use dropdown or create TACC nav component (GH-12) */
  /* NOTE: This does NOT behave exactly like a dropdown:
      1. If menu is open, and screen width changes trigger nav layout transition from mobile to desktop to mobile, then menu will remain open upon return to mobile layout. But a dropdown inside this navbar that was open would be closed after the return.
      2. If menu is open, and user clicks anywhere outside the navbar, then menu will remain open. But a dropdown anywhere that was open would be closed after the click.
  */
  .s-header .navbar-collapse {
    position: absolute; /* expects Bootstrap `.navbar { position: relative }` */

    top: 100%;
    left: 0;
    right: env(--header-navbar-right-pad);
    z-index: 1; /* To be above main content in Portal & Docs */
  }

}





/* Nav */



/* Nav: Variables */

@media (--nav-expanded) {
  .s-header .navbar-nav {
    --nav-line-color: transparent;
    --nav-link-vert-pad: unset;
    /* SEE: "Nav: Variables (Addendum)" */
    /* --nav-link-horz-pad: … */
  }
}
@media (--nav-compressed) {
  .s-header .navbar-nav {
    --nav-line-color: env(--header-accent-color);
    --nav-link-vert-pad: 0.425em;
    /* To line up navbar left-hand content with logo */
    --nav-link-horz-pad: env(--header-navbar-left-pad);
  }
}



/* Nav: Variables (Addendum) */

/* To reduce space between nav links when space is limited */
/* NOTE: This was designed by dev, but mimics Bootstrap behavior */
@media (--nav-expanded) and (--nav-wide-and-below)  {
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-cms` selector prefix */
  :--for-cms .s-header:not(.is-on-portal) .navbar-nav {
    --nav-link-horz-pad: 1em;
  }
}
/* FAQ: Reduce space at wider breakpoint when Portal Nav is present */
@media (--nav-expanded) and (--nav-x-wide-and-below) {
  .s-header.is-on-portal .navbar-nav,
  /* To apply style to old markup (see "Portal & Docs Selectors") */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-*` selectors */
  :--for-docs .s-header .navbar-nav,
  :--for-portal .s-header .navbar-nav {
    --nav-link-horz-pad: 1em;
  }
}

/* To increase space between nav links when space is available */
/* NOTE: This was designed by dev, but mimics Bootstrap behavior */
@media (--nav-expanded) and (--nav-wide-and-above) {
  /* To have 15px of space for 12px font */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-cms` selector prefix */
  :--for-cms .s-header:not(.is-on-portal) .navbar-nav {
    --nav-link-horz-pad: 1.5em;
   }
}
/* FAQ: Increase space at wider breakpoint when Portal Nav is present */
@media (--nav-expanded) and (--nav-x-wide-and-above) {
  /* To have 15px of space for 12px font */
  .s-header.is-on-portal .navbar-nav,
  /* To apply style to old markup (see "Portal & Docs Selectors") */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-*` selectors */
  :--for-docs .s-header .navbar-nav,
  :--for-portal .s-header .navbar-nav {
    --nav-link-horz-pad: 1.5em;
  }
}



/* Nav: Desktop */

@media (--nav-expanded) {

  /* To align CMS nav to the right ONLY if there is no Portal */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-cms` selector prefix */
  :--for-cms .s-header:not(.is-on-portal) .s-cms-nav {
    margin-left: auto;
  }

}



/* Nav: Mobile */

@media (--nav-compressed) {

  /* To overwrite Bootstrap */
  /* To apply style to old markup (see "Portal & Docs Selectors") */
  /* TODO: 1. Remove `ml-auto` from Portal & Docs markup
           2. Remove this style */
  :--for-docs .s-header .s-cms-nav.ml-auto,
  :--for-portal .s-header .s-cms-nav.ml-auto {
    margin-left: 0 !important;
  }

}





/* Nav Link */



/* Nav Link: Selectors */

/* RFE: Fix bug on the Internet so we can use these reliably */
/* SEE: https://github.com/postcss/postcss-custom-selectors/issues/40 */
/*
@custom-selector :--nav-link-hover  .nav-link:hover;
@custom-selector :--nav-link-focus  .nav-link:focus;
@custom-selector :--nav-link-active .nav-link:active;
@custom-selector :--nav-link-current
  .nav-item.active .nav-link,
  .nav-item.dropdown.show .nav-link;
*/



/* Nav Link: General */

.s-header .nav-link {
  /* To support truncation */
  /* To vertically center text and icons (if any) */
  display: flex;
  align-items: center;
}
.s-header .s-portal-nav .nav-link {
  /* To horizontally center align icon, text, and toggle as a group */
  justify-content: center;

  /* To prevent expansion upon dropdown menu open */
  width: var(--portal-navlink-max-width);
}

/* Nav Link: General: Desktop */

@media (--nav-expanded) {
  .s-header .nav-link {
    height: 100%;
  }
  .s-header .s-portal-nav .nav-link {
    background-color: env(--header-portal-nav-bkgd-color);
  }
}

/* Nav Link: General: Mobile */

@media (--nav-compressed) {
  .s-header .s-cms-nav .nav-link {
    font-size: 2em;
  }
  .s-header .s-portal-nav .nav-link {
    /* To align portal nav link to the right */
    margin-left: auto;
  }
}



/* Nav Link: Spacing */

/* FAQ: The `.navbar-nav` is to override Bootstrap specificity */
.s-header .navbar-nav .nav-link,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-portal .s-header .navbar-nav .nav-link {
  padding-right: var(--nav-link-horz-pad, 0);
  padding-left: var(--nav-link-horz-pad, 0);
}
.s-header .nav-link {
  padding-top: var(--nav-link-vert-pad);
  padding-bottom: var(--nav-link-vert-pad);
}

/* Nav Link: Spacing: Desktop */

/* To match design of expanded navbar Portal Nav but take liberty with when */
@media (--nav-expanded), /* match design */
       (--nav-narrow-and-above) and (--nav-compressed) /* dev liberty */ {

  .s-header .s-portal-nav .nav-link,
  /* To overwrite Bootstrap (see "Portal & Docs Selectors") */
  :--for-portal .s-portal-nav .nav-link {
    /* To match space between logo and left side of window */
    --nav-link-horz-pad: env(--header-navbar-left-pad);
  }

  .s-header .s-portal-nav .nav-link .nav-icon {
    margin-right: 0.5em;
  }

}

/* Nav Link: Spacing: Mobile */

/* To match design of collapsed navbar Portal Nav but take liberty with when */
@media (--nav-narrow-and-below) /* dev liberty */ {

  .s-header .s-portal-nav .nav-link {
    min-width: calc(2 * env(--header-navbar-toggle-width)); /* dev liberty */

    padding-top: 0; /* to overwrite Bootstrap */
    padding-bottom: 0; /* to overwrite Bootstrap */
    --nav-link-horz-pad: 1em;
  }

  /* To layout each link as a "mobile button" */
  .s-header .s-portal-nav .nav-link {
    @extend %x-mobile-button--has-toggle;
    display: grid;
  }
  .s-header .s-portal-nav .nav-link .nav-icon {
    @extend %x-mobile-button__icon;
  }
  .s-header .s-portal-nav .nav-link span {
    @extend %x-mobile-button__text;
  }
  .s-header .s-portal-nav .nav-link::after {
    @extend %x-mobile-button__toggle;
  }

}



/* Nav Link: Separator */

/* To create line between each item */
.s-header .nav-item + .nav-item .nav-link {
  /* To ensure any background color does not cover box-shadow */
  position: relative;

  box-shadow:
    /* x pos. */ calc(var(--nav-link-horz-pad) / 2)
    /* y pos. */ calc(-1 * (2px + calc(var(--nav-link-horz-pad) / 2)))
    /* blur */   0
    /* spread */ calc(-1 * calc(var(--nav-link-horz-pad) / 2))
    /* color */  var(--nav-line-color);
}



/* Nav Link: State */

/* To set color and override Bootstrap */
/* FAQ: The `.navbar-dark` would override Bootstrap specificity
        but Bootstrap is loaded after header code in Portal & Docs */
.s-header/*.navbar-dark*/ .nav-link,
.s-header/*.navbar-dark*/ .nav-link:focus,
.s-header/*.navbar-dark*/ .nav-link:hover {
  color: env(--header-text-color) !important; /* to override Bootstrap */
}

.s-header .nav-link:hover,
.s-header .nav-link:active,
.s-header .nav-item.active .nav-link,
.s-header .nav-item.dropdown.show .nav-link {
  background-color: env(--header-link-bkgd-color);
}
@media (--nav-expanded) {
  .s-header .s-cms-nav .nav-link:hover,
  .s-header .s-cms-nav .nav-link:focus,
  .s-header .s-cms-nav .nav-link:active,
  .s-header .s-cms-nav .nav-item.active .nav-link,
  .s-header .s-cms-nav .nav-item.dropdown.show .nav-link {
    border-top: env(--border-width--xx-thick) solid transparent;
    border-bottom: env(--border-width--xx-thick) solid env(--header-accent-color);
  }
}



/* Nav Link: Text */

/* To truncate link text */
.s-header .nav-item { min-width: 0; }
.s-header .nav-text { @extend .x-truncate--one-line; }





/*
 * MENUS
 */





/* Dropdown */



/* Dropdown: Variables */

@media (--nav-expanded) {
  .s-header .dropdown {
    --menu-link-horz-pad: 11px;
    --menu-line-color: env(--header-bkgd-color);
  }
}
@media (--nav-compressed) {
  .s-header .dropdown {
    --menu-link-horz-pad: 26px;
    --menu-line-color: transparent;
  }
}



/* Dropdown: Toggle */

.s-header .dropdown-toggle::after {
  @extend %x-arrow;

  --size: 0.375em;
  --line: 0.1em; /* to get 1px at 12px text and 2px at 24px text */
  --color: env(--header-text-color);
  --nudge: 0.24em;

  margin-left: 0.6em;
  position: relative; /* to allow use of `top` (to vertically align) */
}
/* To vertically align with text */
.s-header .dropdown-toggle[aria-expanded="true"]::after {
  @extend %x-arrow--up;
  top: var(--nudge);
}
.s-header .dropdown-toggle[aria-expanded="false"]::after {
  @extend %x-arrow--down;
  bottom: var(--nudge);
}





/* Dropdown Menu */

/* To overwrite Bootstrap */
/* FAQ: Bootstrap has styles we do not want a value for, so `unset` */
.s-header .dropdown-menu {
  margin: unset;

  border-radius: unset;

  font-size: unset;
}



/* Dropdown Menu: Desktop */

@media (--nav-expanded) {

  /* Dropdowns */

  /* To overwrite Bootstrap */
  .s-header .dropdown-menu {
    padding: 7px 0 0;

    background-color: env(--header-link-bkgd-color);
    border: env(--border-width--normal) solid env(--header-accent-color);

    font-size: 12px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  }

}



/* Dropdown Menu: Mobile */

@media (--nav-compressed) {

  /* To overwrite Bootstrap */
  .s-header .dropdown-menu {
    font-size: 20px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  }
  .s-header .s-cms-nav .dropdown-menu {
    padding: 0 0 0.5em 0;

    background-color: transparent;
    border: none;

    /* To indent dropdown menu */
    /* To match CMS nav menu padding */
    margin-left: env(--header-navbar-left-pad);
  }
  .s-header .s-portal-nav .dropdown-menu {
    padding: 0;

    background-color: env(--header-link-bkgd-color);
    border: none;

    /* To align portal nav menu to the right */
    width: max-content;
    margin-left: auto;
  }

}





/* Dropdown Item */



/* Dropdown Item: General */

.s-header .dropdown-item {
  border-left: env(--border-width--x-thick) solid transparent;

  font-weight: env(--medium);
}



/* Dropdown Item: Spacing */

.s-header .dropdown-item {
  padding-left: var(--menu-link-horz-pad);
  padding-right: var(--menu-link-horz-pad);
}

/* Dropdown Item: Spacing: Desktop */

@media (--nav-expanded) {

  /* To overwrite Bootstrap */
  .s-header .dropdown-item {
    padding-top: 0.3em;
    padding-bottom: 0.3em;
  }

}

/* Dropdown Item: Spacing: Mobile */

@media (--nav-compressed) {

  .s-header .dropdown-item {
    /* To overwrite Bootstrap */
    padding-top: var(--nav-link-vert-pad);
    padding-bottom: var(--nav-link-vert-pad);
  }

}



/* Dropdown Item: Separator */

/* To create line between each item */
.s-header .dropdown-item + .dropdown-item {
  /* To ensure any background color does not cover box-shadow */
  position: relative;

  box-shadow:
    /* x pos. */ 0
    /* y pos. */ calc(-1 * (1px + var(--menu-link-horz-pad)))
    /* blur */   0
    /* spread */ calc(-1 * var(--menu-link-horz-pad))
    /* color */  var(--menu-line-color);
}



/* Dropdown Item: State */

.s-header .dropdown-item.active,
.s-header .dropdown-item:active,
.s-header .dropdown-item:focus,
.s-header .dropdown-item:hover {
  border-left-color: env(--header-accent-color);
  background-color: env(--header-bkgd-color);
  box-shadow: none;
}

.s-header .dropdown-item,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header .dropdown-item,
:--for-docs .s-header .dropdown-item.active,
:--for-docs .s-header .dropdown-item:active,
:--for-docs .s-header .dropdown-item:focus,
:--for-docs .s-header .dropdown-item:hover,
:--for-portal .s-header .dropdown-item,
:--for-portal .s-header .dropdown-item.active,
:--for-portal .s-header .dropdown-item:active,
:--for-portal .s-header .dropdown-item:focus,
:--for-portal .s-header .dropdown-item:hover {
  color: env(--header-text-color);
}





/*
 * OTHER
 */





/* Search */



/* Search: Variables */

.s-header .s-search-bar {
  --button-horz-pad: 10px;
  --input-horz-pad: 0.125em;
}
@media (--nav-expanded) {
  .s-header .s-search-bar {
    --input-height: 26px;
    /* WARNING: Do not use `rem` until `html { 62.5%; }` */
    --button-font-size: 18px;
    --input-font-size: 14px;

    /* To match design */
    --space-after-search-before-nav: 12px;

    /* To insert flexible space between search bar and CMS nav */
    --space-before-search: auto;
  }
}
@media (--nav-compressed) {
  .s-header .s-search-bar {
    /* NOTE: Deviates from design cuz "Mobile Nav Top Row" height deviates */
    --input-height: 38px;
    /* WARNING: Do not use `rem` until `html { 62.5%; }` */
    --button-font-size: 24px;
    --input-font-size: 18px;

    /* SEE: "Mobile Nav Top Row" */
    /* --space-after-search-before-nav: … */

    /* To line up logo with navbar left-hand content */
    /* CAVEAT: Portal navbar width is why this value may not match design */
    --space-before-search: env(--header-navbar-left-pad);
  }
}



/* Search: Elements */

.s-header .s-search-bar {
  /* To remove all whitespace */
  /* NOTE: A `font-size: 0` is not necessary if tag whitespace is removed */
  font-size: 0;
}

.s-header .s-search-bar::part(form) {
  display: flex;
  align-items: center;

  position: relative;
}
.s-header .s-search-bar::part(button) {
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);

  box-sizing: content-box;
  height: var(--input-height);
  align-items: center; /* works if has flex layout (does if class is `.icon`) */

  margin: 0;
  padding: 0 var(--button-horz-pad);

  background-color: transparent;
  border: none;

  color: env(--header-text-color);
  font-size: var(--button-font-size);
}
.s-header .s-search-bar::part(input) {
  display: block;
  width: 100%;
  height: var(--input-height);

  margin: 0;
  padding-top: 0;
  padding-bottom: 0;
  /* To indent text by the width of embedded button plus actual padding */
  /* FAQ: Using `text-indent` has text overflow as user enters beyond width */
  /* HELP: Using `text-indent` is prefered (simpler)... how to do sans bug? */
  padding-left: calc(
    var(--button-horz-pad) +
    var(--button-font-size) +
    var(--button-horz-pad) +
    var(--input-horz-pad)
  );
  padding-right: var(--input-horz-pad);

  background-color: env(--header-search-bkgd-color);
  border: env(--border-width--normal) solid env(--header-search-brdr-color);
  border-radius: 5px;

  color: env(--header-text-color);
  font-size: var(--input-font-size);
}



/* Search: Spacing (Margin) */

/* Create space between search bar & portal nav ONLY IF both elements exist */
.s-header.is-on-portal .s-search-bar,
/* To apply style to old markup (see "Portal & Docs Selectors") */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-*` selectors */
:--for-docs .s-header .s-search-bar,
:--for-portal .s-header .s-search-bar {
  margin-right: var(--space-after-search-before-nav, 0);
}
/* Create space before search bar EVEN IF only search bar exists */
.s-header .s-search-bar {
  margin-left: var(--space-before-search, 0);
}
/* To apply style to old markup (see "Portal & Docs Selectors") */
:--for-docs .s-header .s-search-bar,
:--for-portal .s-header .s-search-bar {
  margin-left: var(--space-before-search, 0) !important;
}





/* Mobile Nav Top Row   (Search Bar & Portal Nav)   (Mobile-Only) */

@media (--nav-compressed) {

  /* To move portal nav & search bar to top of navbar */
  /* FAQ: The `.show` & `.collapsing` allow Bootstrap `display: none` to work */
  .s-header .navbar-collapse.show,
  .s-header .navbar-collapse.collapsing {
    display: flex;
    flex-direction: column;
  }
  .s-header .s-portal-nav { order: -1; }
  .s-header .s-search-bar { order: -2; }

  /* To combine search bar & portal nav into one row */
  .s-header .s-search-bar {
    /* To make space for portal nav in which to shove portal nav */
    --space-after-search-before-nav: calc(
      var(--portal-navlink-max-width) + 5px
    );
  }
  .s-header .s-portal-nav {
    /* To not cover search bar and CMS nav */
    z-index: -1;
    /* To shove portal nav into same row as search bar */
    margin-top: calc(-1 * env(--header-navbar-mobile-height));
  }

  /* To set height */
  /* FAQ: We set height of immediate content of elements, because:
          - height for elements is not respected as navbar collapses
          - height for portal nav would hide its dropdown menu
  */
  .s-header .s-search-bar::part(form),
  .s-header .s-portal-nav .nav-link {
    height: var(--header-navbar-height);
  }

  /* To make a fake background */
  /* HACK: Create background with a pseudo element that matches "row" height */
  .s-header .s-portal-nav { position: relative; }
  .s-header .s-portal-nav::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    width: 100%;
    z-index: -1;
    background-color: env(--header-bkgd-color);
  }

}





/* Icons */



/* Icons: Desktop */

@media (--nav-expanded) {

  /* To add space between icon and text for ALL icons */
  .s-header .nav-icon {
    margin-right: 0.5em;
  }

  /* To enlarge ONLY top-level link icons */
  .s-header .nav-link .nav-icon {
    font-size: 26px;
  }

}



/* Icons: Mobile */

@media (--nav-compressed) {

  /* To add space between icon and text for ONLY portal nav top-level and CMS */
  .s-header .s-portal-nav .dropdown-item .nav-icon,
  .s-header .s-cms-nav .nav-icon {
    margin-right: 0.5em;
  }

  /* To enlarge ALL icons */
  .s-header .nav-icon {
    font-size: 26px;
  }

}
