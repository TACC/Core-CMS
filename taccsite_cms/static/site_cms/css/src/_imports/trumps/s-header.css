/*
Header

Styles for elements within a header.

Warning: There are complex overwrites for 3rd-party and subsite code:

- Bootstrap
  (for CMS navigation)
  (for Portal navigation)
- a subset of Bootstrap 3.3.7
  (for CMS body content, can affect navigation)
- Docs
- Portal

Portal & Docs Selectors:

- To select old markup by using subsite-specific selectors, some styles target Portal or Docs. This was necessary because markup changed in CMS during GH-101, but Portal and Docs markup was not updated. If Portal and Docs markup matches that of CMS, then these selectors need not be so specific for _this_ purpose.
- To overwrite Bootstrap by using extra-specific selectors, some styles target Portal or Docs. This was necessary because Bootstrap on both subsites load _after_ these styles (thus took precedence). If we load Bootstrap styles before CMS styles, then these selectors need not be so specific for _this_ purpose.

Markup: s-header.html.twig

Styleguide Trumps.Scopes.Header
*/
@import url("_imports/tools/selectors.css");
@import url("_imports/tools/x-arrow.css");
@import url("_imports/tools/x-truncate.css");
@import url("_imports/tools/x-mobile-button.css");

/* RFE: Make Portal & Docs markup match CMS (see "Portal & Docs Selectors") */
/* RFE: Load Bootstrap before CMS stylesheets (see "Portal & Docs Selectors") */





/*
 * GENERAL
 */





/* Container */

/* To match CMS line-height (see `body`) */
:--for-docs .s-header,
:--for-portal .s-header {
  line-height: 1.4;
}





/* Variables */

/* FAQ: These have `--header` prefix because they can be used outside header */
@media (--nav-expanded) {
  :root {
    --header-brandbar-height: env(--header-brandbar-normal-height);
    --header-navbar-height: env(--header-navbar-normal-height);

    --portal-navlink-max-width: none;
  }
}
@media (--nav-compressed) {
  :root {
    --header-brandbar-height: env(--header-brandbar-mobile-height);
    --header-navbar-height: env(--header-navbar-mobile-height);

    --portal-navlink-max-width: env(--portal-navlink-mobile-max-width);
  }
}





/*
 * BRANDING & LOGO
 */





/* Branding */

.s-header.c-branding,
/* To apply style to old markup (see "Portal & Docs Selectors") */
/* NOTE: The old markup is dynamically replaced by new markup from CMS */
:--for-docs .branding-header,
:--for-portal .branding-header {
  /* To prevent zero-height element as it is loaded */
  height: var(--header-brandbar-height);

  color: var(--global-color-primary--xx-light);
  background-color: var(--global-color-primary--xx-dark);

  /* !!!: Missing env() var `--header-major-border-color` */
  /* To hide border, set this in theme to match `--header-bkgd-color` value */
  /* border-bottom: 1px solid env(--header-major-border-color); */
  border-bottom: 1px solid var(--global-color-primary--xx-light);
}

/* To avoid squished branding on super narrow screens */
@media (--xx-narrow-and-below) {
  .s-header .c-branding__image {
    /* To allow image to shrink so spacing occurs in narrow box */
    max-width: 80%;
  }
}





/* Logo */

#header-logo {
  /* To allow projects to change value and responsive design to use value */
  --space-after-logo-before-nav: 25px;

  display: flex;
  align-items: center;

  /* To overwrite Bootstrap */
  margin-right: var(--space-after-logo-before-nav);

  /* FAQ: In case image does not load and browser shows alt text */
  color: env(--header-text-color);
}
/* To overwrite Bootstrap */
#header-logo.navbar-brand {
  padding-top: unset;
  padding-bottom: unset;
}

#header-logo .c-logo__image {
  padding-top: 5px;
  padding-bottom: 5px;

  /* Of base i.e. container */
  /* To avoid a project shrinking logo beyond legibility */
  min-height: 50%;
  min-width: 50%;
}



/* Logo: Mobile */

@media (--nav-expanded) {
  #header-logo {
    /* To manage logo width influence on other elements */
    /* To prevent zero-width element as it is loaded */
    /* To align position of first CMS nav link with Portal section headers */
    /* CAVEAT: Only works on narrow-enough logos */
    min-width: calc(190px - var(--space-after-logo-before-nav));

    /* To align logo (whole image not just visible pixels) w/ Portal side nav */
    margin-left: env(--header-navbar-normal-left-pad);
  }
}



/* Logo: Desktop */

@media (--nav-compressed) {
  #header-logo {
    /* To prevent wide image from forcing `.navbar-toggler` to be wrapped */
    max-width: calc(188px - var(--space-after-logo-before-nav));

    /* To match space between logo and left side of window */
    margin-left: env(--header-navbar-mobile-left-pad);
  }
}





/*
 * NAVIGATION
 */





/* Navbar */



/* Navbar: Selectors */

@custom-selector :--nav-bar-fake-bkgd  .s-header.navbar::after;



/* Navbar: General */

.s-header.navbar {
  font-size: 12px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  font-weight: env(--bold);
  font-family: env(--header-font-family);

  /* Copied from Portal (via `body`) */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* To color navbar, but allow CMS nav to be transluscent to body content */
:--nav-bar-fake-bkgd {
  content: '';

  position: absolute;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;

  background-color: env(--header-bkgd-color);
}

/* To overwrite Bootstrap */
.s-header.navbar,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header.navbar,
:--for-portal .s-header.navbar {
  padding: 0;
}

/* To stretch elements as tall as parent */
.s-header.navbar,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header.navbar,
:--for-portal .s-header.navbar,
/* To propogate styles through extra wrapper (of Bootstrap-driven mobile nav) */
.s-header .navbar-collapse {
  align-items: stretch;
}



/* Navbar: Dimensions for Descendants */

/* To prevent zero-height element as it is loaded */
/* FAQ: The zero-height fix is most obvious on Portal/Docs or slow network */
/* To prevent extra height from FOUC during Portal/Docs AJAX content load */
/* To set nav height, but not constrain height of opened mobile nav */
/* FAQ: Set height of descendants, but not of CMS and Portal and mobile navs */
:--nav-bar-fake-bkgd,
#header-logo,
.s-header :--navbar-toggle,
.s-header .s-search-bar {
  height: var(--header-navbar-height);
}

/* To support shrinking and truncation of certain nav elements */
/* SEE: https://css-tricks.com/flexbox-truncated-text/ */
.s-header .navbar-collapse,
  #header-logo,
  .s-header .s-cms-nav,
  .s-header .s-search-bar { min-width: 0; }







/* Navbar Toggle   (Mobile-Only) */



/* Navbar Toggle: Selectors */

@custom-selector :--navbar-toggle
  .navbar-toggler;
@custom-selector :--navbar-toggle--opened
  .navbar-toggler[aria-expanded="true"];
@custom-selector :--navbar-toggle--closed
  .navbar-toggler[aria-expanded="false"];



/* Navbar Toggle: Mobile */

@media (--nav-compressed) {

  /* Layout */

  /* To layout the toggle as a "mobile button" */
  .s-header :--navbar-toggle--opened,
  .s-header :--navbar-toggle--closed {
    /* WARNING: Do not set `display` outside of (--nav-compressed) */
    /* FAQ: The button as Bootstrap `.navbar-toggler` uses `display: none` */
    display: grid;
  }
  .s-header :--navbar-toggle--opened { @extend %x-mobile-button--only-icon; }
  .s-header :--navbar-toggle--closed { @extend %x-mobile-button--no-toggle; }
  .s-header :--navbar-toggle::after  { @extend %x-mobile-button__text; }
  .s-header :--navbar-toggle::before { @extend %x-mobile-button__icon; }



  /* Button */

  /* To layout the button */
  .s-header :--navbar-toggle {
    width: env(--header-navbar-toggle-width);

    /* Prevent wrap of button while it has static width */
    /* FAQ: Wrap happens if logo is wide and button layout is not flexible */
    /* FAQ: Set flexible width that never wraps button (on Frontera) */
    /* FAQ: Set maximum width at env. variable */
    margin-right: clamp(0px, 15%, env(--header-navbar-mobile-right-pad));
  }

  /* To style the button */
  .s-header :--navbar-toggle {
    padding: 0; /* to overwrite Bootstrap */

    background-color: env(--header-portal-nav-bkgd-color);

    /* To overwrite Bootstrap */
    border: none;
    border-radius: 0;
  }

  /* To isolate styles that require more specificity to override Portal */
  .s-header :--navbar-toggle,
  /* To overwrite Bootstrap (see "Portal & Docs Selectors") */
  :--for-docs .s-header :--navbar-toggle,
  :--for-portal .s-header :--navbar-toggle {
    color: env(--header-text-color);
  }

  .s-header :--navbar-toggle:hover,
  .s-header :--navbar-toggle:active {
    background-color: env(--header-link-bkgd-color);
  }



  /* Icon */

  /* To overwrite Bootstrap */
  .s-header .navbar-toggler-icon { display: none; }
  /* To swap Bootstrap icon for Cortal icon */
  /* HACK: To apply icon styles without using a class in the markup */
  /* FAQ: For dynamic markup change, Portal & Docs markup must be updated */
  /* SEE: https://getbootstrap.com/docs/4.0/components/collapse/#events */
  .s-header :--navbar-toggle { @extend [class*=" icon-"]; }
  .s-header :--navbar-toggle::before { @extend .icon; }
  /* To change icon without using dynamic icon classes */
  .s-header :--navbar-toggle--opened { @extend .icon-close; }
  .s-header :--navbar-toggle--closed { @extend .icon-burger; }
  /* To stretch icon to mimic icon in design (which is not available yet) */
  .s-header :--navbar-toggle--closed::before { transform: scaleX(1.5); }
  /* To overwrite `.icon` */
  .s-header :--navbar-toggle::before {
    font-size: 30px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  }



  /* Text */

  .s-header :--navbar-toggle::after {
    content: attr(data-icon-label);
  }
  /* To apply style to old markup (see "Portal & Docs Selectors") */
  /* FAQ: This selector does not use `:--for-portal` but has similar purpose */
  .s-header :--navbar-toggle:not([data-icon-label])::after {
    content: 'Menu';
  }
  /* FAQ: Only the closed state is supposed to have text */
  .s-header :--navbar-toggle--opened::after { display: none; }

}





/* Navbar Collapsible   (Mobile-Only) */



/* Navbar Collapsible: Mobile */

@media (--nav-compressed) {

  /* Style */

  .s-header .navbar-collapse {
    padding-top: 12px;

    @supports (backdrop-filter: none) {
      & {
        backdrop-filter: blur(18px) brightness(85%);
        background-color: rgba(var(--global-color-primary--x-dark-rgb), 0.6);
      }
    }
    @supports not (backdrop-filter: none) {
      & {
        background-color: rgba(var(--global-color-primary--x-dark-rgb), 0.95);
      }
    }

    border: env(--border-width--normal) solid var(--global-color-primary--dark);
  }



  /* Layout */

  /* HACK: To make the navbar act similar to a dropdown */
  /* TODO: We should either use dropdown or create TACC nav component (GH-12) */
  /* CAVEAT: If menu is open, and layout switches from collapsed to expanded to collapsed, then menu will remain open upon return to collapsed layout.
  /* CAVEAT: If menu is open, and user clicks anywhere outside the navbar, then menu remains open. But a real dropdown would be closed after such a click. */
  .s-header .navbar-collapse {
    position: absolute; /* assumes Bootstrap `.navbar { position: relative }` */
    top: 100%;
    left: 0;
    right: env(--header-navbar-mobile-right-pad);
    z-index: 1; /* To be above main content in Portal & Docs */
  }

}





/* Nav */



/* Nav: Variables */

@media (--nav-expanded) {
  .s-header .navbar-nav {
    --nav-line-color: transparent;
    --nav-link-vert-pad: unset;
    /* SEE: "Nav: Variables (Addendum)" */
    /* --nav-link-horz-pad: … */
  }
}
@media (--nav-compressed) {
  .s-header .navbar-nav {
    --nav-line-color: env(--header-accent-color);
    --nav-link-vert-pad: 0.425em;
    /* To line up navbar left-hand content with logo */
    --nav-link-horz-pad: calc(env(--header-navbar-toggle-width) / 2);
  }
}



/* Nav: Variables (Addendum) */

/* To reduce space between nav links when space is limited */
/* NOTE: This was designed by dev, but mimics Bootstrap behavior */
@media (--nav-expanded) and (--nav-wide-and-below)  {
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-cms` selector prefix */
  :--for-cms .s-header:not(.is-on-portal) .navbar-nav {
    --nav-link-horz-pad: 1em;
  }
}
/* FAQ: Reduce space at wider breakpoint when Portal Nav is present */
@media (--nav-expanded) and (--nav-x-wide-and-below) {
  .s-header.is-on-portal .navbar-nav,
  /* To apply style to old markup (see "Portal & Docs Selectors") */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-*` selectors */
  :--for-docs .s-header .navbar-nav,
  :--for-portal .s-header .navbar-nav {
    --nav-link-horz-pad: 1em;
  }
}

/* To increase space between nav links when space is available */
/* NOTE: This was designed by dev, but mimics Bootstrap behavior */
@media (--nav-expanded) and (--nav-wide-and-above) {
  /* To have 15px of space for 12px font */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-cms` selector prefix */
  :--for-cms .s-header:not(.is-on-portal) .navbar-nav {
    --nav-link-horz-pad: 1.5em;
   }
}
/* FAQ: Increase space at wider breakpoint when Portal Nav is present */
@media (--nav-expanded) and (--nav-x-wide-and-above) {
  /* To have 15px of space for 12px font */
  .s-header.is-on-portal .navbar-nav,
  /* To apply style to old markup (see "Portal & Docs Selectors") */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-*` selectors */
  :--for-docs .s-header .navbar-nav,
  :--for-portal .s-header .navbar-nav {
    --nav-link-horz-pad: 1.5em;
  }
}



/* Nav: Desktop */

@media (--nav-expanded) {

  /* To align CMS nav to the right ONLY if there is no Portal */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-cms` selector prefix */
  :--for-cms .s-header:not(.is-on-portal) .s-cms-nav {
    margin-left: auto;
    margin-right: env(--header-navbar-normal-right-pad);
  }

}



/* Nav: Mobile */

@media (--nav-compressed) {

  /* To overwrite Bootstrap */
  /* To apply style to old markup (see "Portal & Docs Selectors") */
  /* TODO: 1. Remove `ml-auto` from Portal & Docs markup
           2. Remove this style */
  :--for-docs .s-header .s-cms-nav.ml-auto,
  :--for-portal .s-header .s-cms-nav.ml-auto {
    margin-left: 0 !important;
  }

  /* To match design */
  .s-cms-nav {
    padding-top: 8px;
  }

}





/* Nav Link */



/* Nav Link: Selectors */

/* RFE: Fix bug on the Internet so we can use these reliably */
/* SEE: https://github.com/postcss/postcss-custom-selectors/issues/40 */
/*
@custom-selector :--nav-link--hover  .nav-link:hover;
@custom-selector :--nav-link--focus  .nav-link:focus;
@custom-selector :--nav-link--active .nav-link:active;
@custom-selector :--nav-link--current
  .nav-item.active .nav-link,
  .nav-item.dropdown.show .nav-link;
*/
@custom-selector :--portal-nav-link--user
  .s-portal-nav .nav-link.dropdown-toggle;
@custom-selector :--portal-nav-link--guest
  .s-portal-nav .nav-link:not(.dropdown-toggle);
@custom-selector :--portal-nav-link__icon
  .s-portal-nav .nav-link .icon;
@custom-selector :--portal-nav-link__text
  .s-portal-nav .nav-link .nav-text;




/* Nav Link: General */

.s-header .nav-link {
  /* To support truncation */
  /* To vertically center text and icons (if any) */
  display: flex;
  align-items: center;
}
.s-header .s-portal-nav .nav-link {
  /* To horizontally center align icon, text, and toggle as a group */
  justify-content: center;

  /* To prevent expansion upon dropdown menu open */
  width: var(--portal-navlink-max-width);

  /* To prevent "Log In" from wrapping as it slides into place */
  /* NOTE: This affects username also, but it should not have any whitespace */
  white-space: nowrap;
}

/* Nav Link: General: Desktop */

@media (--nav-expanded) {
  .s-header .nav-link {
    height: 100%;
  }
  .s-header .s-portal-nav .nav-link {
    background-color: env(--header-portal-nav-bkgd-color);
  }
}

/* Nav Link: General: Mobile */

@media (--nav-compressed) {
  .s-header .s-cms-nav .nav-link {
    font-size: 2em;
  }
  .s-header .s-portal-nav .nav-link {
    /* To align portal nav link to the right */
    margin-left: auto;
  }
}



/* Nav Link: Spacing */

/* FAQ: The `.navbar-nav` is to override Bootstrap specificity */
.s-header .navbar-nav .nav-link,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-portal .s-header .navbar-nav .nav-link {
  padding-right: var(--nav-link-horz-pad, 0);
  padding-left: var(--nav-link-horz-pad, 0);
}
.s-header .nav-link {
  padding-top: var(--nav-link-vert-pad);
  padding-bottom: var(--nav-link-vert-pad);
}

/* Nav Link: Spacing: Desktop */

@media (--nav-expanded) {

  .s-header .s-portal-nav .nav-link,
  /* To overwrite Bootstrap (see "Portal & Docs Selectors") */
  :--for-portal .s-portal-nav .nav-link {
    /* To match space between logo and left side of window */
    --nav-link-horz-pad: env(--header-navbar-normal-left-pad);
  }

  .s-header :--portal-nav-link__icon {
    margin-right: 0.5em;
  }

}

/* Nav Link: Spacing: Mobile */

/* To match design of collapsed navbar Portal Nav but take liberty with when */
@media (--nav-compressed) /* dev liberty */ {

  .s-header .s-portal-nav .nav-link {
    min-width: calc(2 * env(--header-navbar-toggle-width)); /* dev liberty */

    padding-top: 0; /* to overwrite Bootstrap */
    padding-bottom: 0; /* to overwrite Bootstrap */
    /* NOTE: Might as well be zero (given `width` is expected max-width),
             but if username exceeds expectation some padding would look good */
    --nav-link-horz-pad: 1em;
  }

}



/* Nav Link: Icon   (Mobile-Only) */

@media (--nav-compressed) {

  /* Layout */

  /* To layout each link as a "mobile button" */
  .s-header .s-portal-nav .nav-link {
    display: grid;
  }
  .s-header :--portal-nav-link--user {
    @extend %x-mobile-button--has-toggle;
  }
  .s-header :--portal-nav-link--guest {
    @extend %x-mobile-button--no-toggle;
  }
  .s-header :--portal-nav-link__icon {
    @extend %x-mobile-button__icon;
  }
  .s-header .s-portal-nav .nav-link::before {
    @extend %x-mobile-button__text;
  }
  .s-header .s-portal-nav .nav-link::after {
    @extend %x-mobile-button__toggle;
  }



  /* Text */

  /* To apply style to old markup (see "Portal & Docs Selectors") */
  /* FAQ: This selector does not use `:--for-portal` but has similar purpose */
  .s-header :--portal-nav-link--guest::before {
    content: 'Log In';
  }
  /* Use content for text, not actual text */
  /* FAQ: For consistency with `:--navbar-toggle` */
  /* FAQ: Because the text need not be selectable anyway */
  .s-header :--portal-nav-link__text { display: none; }
  /* To hide the stray text */
  .s-header :--portal-nav-link--guest { font-size: 0; }

}



/* Nav Link: Separator */

/* To create line between each item */
.s-header .nav-item + .nav-item .nav-link {
  /* To ensure any background color does not cover box-shadow */
  position: relative;

  box-shadow:
    /* x pos. */ calc(var(--nav-link-horz-pad) / 2)
    /* y pos. */ calc(-1 * (2px + calc(var(--nav-link-horz-pad) / 2)))
    /* blur */   0
    /* spread */ calc(-1 * calc(var(--nav-link-horz-pad) / 2))
    /* color */  var(--nav-line-color);
}



/* Nav Link: State */

/* To set color and override Bootstrap */
/* FAQ: The `.navbar-dark` would override Bootstrap specificity
        but Bootstrap is loaded after header code in Portal & Docs */
.s-header/*.navbar-dark*/ .nav-link,
.s-header/*.navbar-dark*/ .nav-link:focus,
.s-header/*.navbar-dark*/ .nav-link:hover {
  color: env(--header-text-color) !important; /* to override Bootstrap */
}

.s-header .nav-link:hover,
.s-header .nav-link:active,
.s-header .nav-item.active .nav-link {
  background-color: env(--header-link-bkgd-color);
}

/* Nav Link: State: Desktop */

@media (--nav-expanded) {
  .s-header .nav-item.dropdown.show .nav-link {
    background-color: env(--header-link-bkgd-color);
  }
  .s-header .s-cms-nav .nav-link:hover,
  .s-header .s-cms-nav .nav-link:focus,
  .s-header .s-cms-nav .nav-link:active,
  .s-header .s-cms-nav .nav-item.active .nav-link,
  .s-header .s-cms-nav .nav-item.dropdown.show .nav-link {
    border-top: env(--border-width--xx-thick) solid transparent;
    border-bottom: env(--border-width--xx-thick) solid env(--header-accent-color);
  }
}

/* Nav Link: State: Mobile */

/* FAQ: Design does not know what this should be yet */
/*
@media (--nav-compressed) {

}
*/



/* Nav Link: Text */

/* To truncate link text */
.s-header .nav-item { min-width: 0; }
.s-header .nav-text { @extend .x-truncate--one-line; }





/*
 * MENUS
 */





/* Dropdown */



/* Dropdown: Variables */

@media (--nav-expanded) {
  .s-header .dropdown {
    --menu-link-horz-pad: 11px;
    --menu-line-color: env(--header-bkgd-color);
  }
}
@media (--nav-compressed) {
  .s-header .dropdown {
    --menu-link-horz-pad: 26px;
    --menu-line-color: transparent;
  }
}



/* Dropdown: Toggle */

.s-header .dropdown-toggle::after {
  @extend %x-arrow;

  --size: 0.375em;
  --line: 0.1em; /* to get 1px at 12px text and 2px at 24px text */
  --color: env(--header-text-color);
  --nudge: 0.24em;

  margin-left: 0.6em;
  position: relative; /* to allow use of `top` (to vertically align) */
}
/* To vertically align with text */
.s-header .dropdown-toggle[aria-expanded="true"]::after {
  @extend %x-arrow--up;
  top: var(--nudge);
}
.s-header .dropdown-toggle[aria-expanded="false"]::after {
  @extend %x-arrow--down;
  bottom: var(--nudge);
}





/* Dropdown Menu */

/* To layout menu */
.s-header .s-portal-nav .dropdown-menu {
  /* To stretch dropdown width to match width of its parent */
  width: 100%;
}

/* To style menu */
/* To overwrite Bootstrap */
/* FAQ: Bootstrap has styles we do not want a value for, so `unset` */
.s-header .dropdown-menu {
  margin: unset;

  border-radius: unset;
}



/* Dropdown Menu: Desktop */

@media (--nav-expanded) {

  /* Dropdowns */

  /* To overwrite Bootstrap */
  .s-header .dropdown-menu {
    padding: 7px 0 0;

    background-color: env(--header-link-bkgd-color);
    border: env(--border-width--normal) solid env(--header-accent-color);

    font-size: 12px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  }

}



/* Dropdown Menu: Mobile */

@media (--nav-compressed) {

  /* To overwrite Bootstrap */
  .s-header .dropdown-menu {
    font-size: 20px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  }
  .s-header .s-cms-nav .dropdown-menu {
    padding: 0 0 0.5em 0;

    background-color: transparent;
    border: none;

    /* To indent dropdown menu */
    /* To match CMS nav menu padding */
    margin-left: calc(env(--header-navbar-toggle-width) / 2);
  }
  .s-header .s-portal-nav .dropdown-menu {
    /* To retain dropdown, not push-down, behavior */
    /* FAQ: Bootstrap uses `static` for navbar dropdowns until wide screen */
    position: absolute;

    padding: 0;

    background-color: env(--header-link-bkgd-color);
    border: none;
  }

}





/* Dropdown Item */



/* Dropdown Item: General */

.s-header .dropdown-item {
  border-left: env(--border-width--x-thick) solid transparent;

  font-weight: env(--medium);
}



/* Dropdown Item: Spacing */

.s-header .dropdown-item {
  --nav-link-vert-pad: 0.4em;

  /* To overwrite Bootstrap */
  padding: var(--nav-link-vert-pad) var(--menu-link-horz-pad);
}



/* Dropdown Item: Separator */

/* To create line between each item */
.s-header .dropdown-item + .dropdown-item {
  /* To ensure any background color does not cover box-shadow */
  position: relative;

  box-shadow:
    /* x pos. */ 0
    /* y pos. */ calc(-1 * (1px + var(--menu-link-horz-pad)))
    /* blur */   0
    /* spread */ calc(-1 * var(--menu-link-horz-pad))
    /* color */  var(--menu-line-color);
}



/* Dropdown Item: State */

.s-header .dropdown-item.active,
.s-header .dropdown-item:active,
.s-header .dropdown-item:focus,
.s-header .dropdown-item:hover {
  border-left-color: env(--header-accent-color);
  background-color: env(--header-bkgd-color);
  box-shadow: none;
}

.s-header .dropdown-item,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header .dropdown-item,
:--for-docs .s-header .dropdown-item.active,
:--for-docs .s-header .dropdown-item:active,
:--for-docs .s-header .dropdown-item:focus,
:--for-docs .s-header .dropdown-item:hover,
:--for-portal .s-header .dropdown-item,
:--for-portal .s-header .dropdown-item.active,
:--for-portal .s-header .dropdown-item:active,
:--for-portal .s-header .dropdown-item:focus,
:--for-portal .s-header .dropdown-item:hover {
  color: env(--header-text-color);
}





/*
 * OTHER
 */





/* Search */



/* Search: Variables */

.s-header .s-search-bar {
  --button-horz-pad: 10px;
  --input-horz-pad: 0.125em;
}
@media (--nav-expanded) {
  .s-header .s-search-bar {
    --input-height: 26px;
    /* WARNING: Do not use `rem` until `html { 62.5%; }` */
    --button-font-size: 18px;
    --input-font-size: 14px;

    /* To match design */
    --space-after-search-before-nav: 12px;

    /* To insert flexible space between search bar and CMS nav */
    --space-before-search: auto;
  }
}
@media (--nav-compressed) {
  .s-header .s-search-bar {
    /* NOTE: Deviates from design cuz "Mobile Nav Top Row" height deviates */
    --input-height: 38px;
    /* WARNING: Do not use `rem` until `html { 62.5%; }` */
    --button-font-size: 24px;
    --input-font-size: 18px;

    /* SEE: "Mobile Nav Top Row" */
    /* --space-after-search-before-nav: … */

    /* To line up logo with navbar left-hand content */
    --space-before-search: env(--header-navbar-mobile-left-pad);
  }
}



/* Search: Elements */

.s-header .s-search-bar {
  /* To remove all whitespace */
  /* NOTE: A `font-size: 0` is not necessary if tag whitespace is removed */
  font-size: 0;
}

.s-header .s-search-bar::part(form) {
  display: flex;
  align-items: center;

  position: relative;
}
.s-header .s-search-bar::part(button) {
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);

  box-sizing: content-box;
  height: var(--input-height);
  align-items: center; /* works if has flex layout (does if class is `.icon`) */

  margin: 0;
  padding: 0 var(--button-horz-pad);

  background-color: transparent;
  border: none;

  color: env(--header-text-color);
  font-size: var(--button-font-size);
}
.s-header .s-search-bar::part(input) {
  display: block;
  width: 100%;
  height: var(--input-height);

  margin: 0;
  padding-top: 0;
  padding-bottom: 0;
  /* To indent text by the width of embedded button plus actual padding */
  /* FAQ: Using `text-indent` has text overflow as user enters beyond width */
  /* HELP: Using `text-indent` is prefered (simpler)... how to do sans bug? */
  padding-left: calc(
    var(--button-horz-pad) +
    var(--button-font-size) +
    var(--button-horz-pad) +
    var(--input-horz-pad)
  );
  padding-right: var(--input-horz-pad);

  background-color: env(--header-search-bkgd-color);
  border: env(--border-width--normal) solid env(--header-search-brdr-color);
  border-radius: 5px;

  color: env(--header-text-color);
  font-size: var(--input-font-size);
}



/* Search: Spacing (Margin) */

/* Create space between search bar & portal nav ONLY IF both elements exist */
.s-header.is-on-portal .s-search-bar,
/* To apply style to old markup (see "Portal & Docs Selectors") */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-*` selectors */
:--for-docs .s-header .s-search-bar,
:--for-portal .s-header .s-search-bar {
  margin-right: var(--space-after-search-before-nav, 0);
}
/* Create space before search bar EVEN IF only search bar exists */
.s-header .s-search-bar {
  margin-left: var(--space-before-search, 0);
}
/* To apply style to old markup (see "Portal & Docs Selectors") */
:--for-docs .s-header .s-search-bar,
:--for-portal .s-header .s-search-bar {
  margin-left: var(--space-before-search, 0) !important;
}





/* Mobile Nav Top Row   (Search Bar & Portal Nav)   (Mobile-Only) */

@media (--nav-compressed) {

  /* To move portal nav & search bar to top of navbar */
  /* FAQ: The `.show` & `.collapsing` allow Bootstrap `display: none` to work */
  .s-header .navbar-collapse.show,
  .s-header .navbar-collapse.collapsing {
    display: flex;
    flex-direction: column;
  }
  .s-header .s-portal-nav { order: -1; }
  .s-header .s-search-bar { order: -2; }

  /* To combine search bar & portal nav into one row */
  .s-header .s-search-bar {
    /* To make space for portal nav in which to shove portal nav */
    --space-after-search-before-nav: calc(
      var(--portal-navlink-max-width) + 5px
    );
  }
  .s-header .s-portal-nav {
    /* To shove portal nav into same row as search bar */
    margin-top: calc(-1 * env(--header-navbar-mobile-height));
  }

  /* To set height */
  /* FAQ: We set height of immediate content of elements, because:
          - height for elements is not respected as navbar collapses
          - height for portal nav would hide its dropdown menu
  */
  .s-header .s-search-bar::part(form),
  .s-header .s-portal-nav .nav-link {
    height: var(--header-navbar-height);
  }

  /* To make a fake background */
  /* HACK: Create background with a pseudo element that matches "row" height */
  .s-header .s-portal-nav { position: relative; }
  .s-header .s-portal-nav::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    width: 100%;
    z-index: -1;
    background-color: env(--header-bkgd-color);
  }
  /* To ensure search bar can be focused i.e. is above the fake background */
  .s-header .s-search-bar { z-index: 1; }

}





/* Icons */



.s-header .icon {
  /* HACK: The `!important` overrides Portal's temporary <style> CSS */
  /* AFTER GH-101: Portal: Remove `!important` */
  font-size: 26px !important;
}



/* Icons: Desktop */

@media (--nav-expanded) {

  /* To add space between icon and text for ALL icons */
  .s-header .icon {
    margin-right: 0.5em;
  }

}



/* Icons: Mobile */

@media (--nav-compressed) {

  /* To add space between icon and text for ONLY portal nav top-level and CMS */
  .s-header .s-portal-nav .dropdown-item .icon,
  .s-header .s-cms-nav .icon {
    margin-right: 0.5em;
  }

}
