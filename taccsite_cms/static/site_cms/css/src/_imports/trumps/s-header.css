/*
Header

Styles for elements within a header.

Warning: There are complex overwrites for 3rd-party and subsite code:

- Bootstrap
  (for CMS navigation)
  (for Portal navigation)
- a subset of Bootstrap 3.3.7
  (for CMS body content, can affect navigation)
- Docs
- Portal

Portal & Docs Selectors:

- To select old markup by using subsite-specific selectors, some styles target Portal or Docs. This was necessary because markup changed in CMS during GH-101, but Portal and Docs markup was not updated. If Portal and Docs markup matches that of CMS, then these selectors need not be so specific for _this_ purpose.
- To overwrite Bootstrap by using extra-specific selectors, some styles target Portal or Docs. This was necessary because Bootstrap on both subsites load _after_ these styles (thus took precedence). If we load Bootstrap styles before CMS styles, then these selectors need not be so specific for _this_ purpose.

Markup: s-header.html.twig

Styleguide Trumps.Scopes.Header
*/
@import url("_imports/tools/selectors.css");
@import url("_imports/tools/x-arrow.css");
@import url("_imports/tools/x-truncate.css");
@import url("_imports/tools/x-mobile-button.css");

/* RFE: Make Portal & Docs markup match CMS (see "Portal & Docs Selectors") */
/* RFE: Load Bootstrap before CMS stylesheets (see "Portal & Docs Selectors") */





/*
 * MIXINS
 */





/* To create noticable line between each item */
%s-header-nav-link-border {
  /* To ensure any background color does not cover box-shadow */
  position: relative;

  box-shadow:
    /* x pos. */ calc(var(--nav-link-horz-pad) / 2)
    /* y pos. */ calc(-1 * (2px + calc(var(--nav-link-horz-pad) / 2)))
    /* blur */   0
    /* spread */ calc(-1 * calc(var(--nav-link-horz-pad) / 2))
    /* color */  var(--nav-line-color);
}

/* To create negligible line between each item */
%s-header-menu-link-border {
  /* To ensure any background color does not cover box-shadow */
  position: relative;

  box-shadow:
    /* x pos. */ 0
    /* y pos. */ calc(-1 * (1px + var(--menu-link-horz-pad)))
    /* blur */   0
    /* spread */ calc(-1 * var(--menu-link-horz-pad))
    /* color */  var(--menu-line-color);
}

%s-header-mobile-menu {
  /* Layout: To stretch menu to cover most of page */
  position: fixed;
  top: 0;
  right: 0;
  height: 100vh;
  width: calc(100vw - env(--header-navbar-mobile-menu-offset));

  /* Layout: To be above body content on Portal & Docs (not harmful on CMS) */
  z-index: 2; /* 2 overlaps `.s-header__menu-backdrop` on page with scrollbar */

  /* Style */
  padding-top: env(--header-brandbar-mobile-height);
  background-color: env(--header-link-bkgd-color);
  border-left: env(--border-width--normal) solid var(--global-color-primary--dark);
}





/*
 * JAVASCRIPT
 */





@media (--nav-compressed) {

  /* To allow a click outside a menu to close the menu */
  .s-header .show + .s-header__menu-backdrop {
    /* Layout: To stretch element to always span full screen size */
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    width: env(--header-navbar-mobile-menu-offset);

    /* Layout: To be above body content on Portal & Docs (not harmful on CMS) */
    z-index: 1;

    /* Style: To blur and/or lighten the content behind the element */
    @supports (backdrop-filter: none) {
      & {
        /* To blur and lighten content behind the element */
        backdrop-filter: blur(18px) brightness(85%);
        background-color: transparent;
      }
    }
    @supports not (backdrop-filter: none) {
      & {
        /* To lighten content behind the element */
        background-color: rgba(var(--global-color-primary--x-light-rgb), 0.75);
      }
    }
  }

}





/*
 * GENERAL
 */





/* Container */

/* To match CMS line-height (see `body`) */
:--for-docs .s-header,
:--for-portal .s-header {
  line-height: 1.4;
}





/* Elements */

/* To overwrite html-elements.css */
.s-header a:active {
  position: unset;
  top: unset;
}





/* Variables */

@media (--nav-expanded) {
  :root {
    --header-brandbar-height: env(--header-brandbar-normal-height);
    --header-navbar-height: env(--header-navbar-normal-height);

    --portal-navlink-max-width: none;
  }

  .s-header {
    --menu-link-horz-pad: 11px;
    --menu-line-color: env(--header-bkgd-color);

    --nav-line-color: transparent;
    --nav-link-vert-pad: unset;
    /* SEE: "Nav: Variables (Addendum)" */
    /* --nav-link-horz-pad: â€¦ */
  }
}
@media (--nav-compressed) {
  :root {
    --header-brandbar-height: env(--header-brandbar-mobile-height);
    --header-navbar-height: env(--header-navbar-mobile-height);

    --portal-navlink-max-width: env(--portal-navlink-mobile-max-width);
  }

  .s-header {
    --menu-link-horz-pad: 24px;
    --menu-line-color: transparent;

    --nav-line-color: env(--header-accent-color);
    --nav-link-vert-pad: 12px;
    /* To line up navbar left-hand content with logo */
    --nav-link-horz-pad: calc(env(--header-navbar-toggle-width) / 2);
  }
}





/*
 * BRANDING & LOGO
 */





/* Branding */

.s-header.c-branding,
/* To apply style to old markup (see "Portal & Docs Selectors") */
/* NOTE: The old markup is dynamically replaced by new markup from CMS */
:--for-docs .branding-header,
:--for-portal .branding-header {
  /* To prevent zero-height element as it is loaded */
  height: var(--header-brandbar-height);

  color: var(--global-color-primary--xx-light);
  background-color: var(--global-color-primary--xx-dark);

  /* !!!: Missing env() var `--header-major-border-color` */
  /* To hide border, set this in theme to match `--header-bkgd-color` value */
  /* border-bottom: 1px solid env(--header-major-border-color); */
  border-bottom: 1px solid var(--global-color-primary--xx-light);
}

/* To avoid squished branding on super narrow screens */
@media (--xx-narrow-and-below) {
  .s-header .c-branding__image {
    /* To allow image to shrink so spacing occurs in narrow box */
    max-width: 80%;
  }
}





/* Logo */

#header-logo {
  display: flex;
  align-items: center;

  /* FAQ: In case image does not load and browser shows alt text */
  color: env(--header-text-color);
}
/* To overwrite Bootstrap */
#header-logo.navbar-brand {
  padding-top: unset;
  padding-bottom: unset;
}

#header-logo .c-logo__image {
  padding-top: 5px;
  padding-bottom: 5px;

  /* Of base i.e. container */
  /* To avoid a project shrinking logo beyond legibility */
  min-height: 50%;
  min-width: 50%;
}





/*
 * NAVIGATION
 */





/* Navbar */



/* Navbar: Selectors */

@custom-selector :--nav-bar-fake-bkgd  .s-header.navbar::after;



/* Navbar: General */

.s-header.navbar {
  font-size: 12px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  font-weight: env(--bold);
  font-family: env(--header-font-family);

  /* Copied from Portal (via `body`) */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* To color navbar, but allow CMS nav to be transluscent to body content */
:--nav-bar-fake-bkgd {
  content: '';

  position: absolute;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;

  background-color: env(--header-bkgd-color);
}

/* To overwrite Bootstrap */
.s-header.navbar {
  flex-wrap: nowrap;
}
.s-header.navbar,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header.navbar,
:--for-portal .s-header.navbar {
  padding: 0;
}

/* To stretch elements as tall as parent */
.s-header.navbar,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header.navbar,
:--for-portal .s-header.navbar,
/* To propogate styles through extra wrapper (of Bootstrap-driven mobile nav) */
.s-header .navbar-collapse {
  align-items: stretch;
}



/* Navbar: Dimensions for Descendants */

/* To prevent zero-height element as it is loaded */
/* FAQ: The zero-height fix is most obvious on Portal/Docs or slow network */
/* To prevent extra height from FOUC during Portal/Docs AJAX content load */
/* To set nav height, but not constrain height of opened mobile nav */
/* FAQ: Set height of descendants, but not of CMS and Portal and mobile navs */
:--nav-bar-fake-bkgd,
#header-logo,
/* FAQ: We set height of immediate content of elements, because:
        - height for navbar elements is not respected as navbar collapses
        - height for portal nav would hide its dropdown menu */
.s-header :--navbar-toggle,
.s-header .navbar-collapse:not(.show) .s-search-bar::part(form),
.s-header :--portal-button {
  height: var(--header-navbar-height);
}
.s-header .navbar-collapse:is(.show, .collapsing) .s-search-bar::part(form),
.s-header :--portal-message {
  height: env(--header-navbar-normal-height);
}

/* To support shrinking and truncation of certain nav elements */
/* SEE: https://css-tricks.com/flexbox-truncated-text/ */
.s-header .navbar-collapse,
  .s-header .s-cms-nav,
  .s-header .s-search-bar { min-width: 0; }







/* Navbar Toggle   (Mobile-Only) */



/* Navbar Toggle: Selectors */

@custom-selector :--navbar-toggle
  .navbar-toggler;
@custom-selector :--navbar-toggle__text
  .navbar-toggler-text;
@custom-selector :--navbar-toggle__icon
  .navbar-toggler-icon;
@custom-selector :--navbar-toggle--opened
  .navbar-toggler[aria-expanded="true"];
@custom-selector :--navbar-toggle--closed
  .navbar-toggler[aria-expanded="false"];



/* Navbar Toggle: Mobile */

@media (--nav-compressed) {

  /* Layout */

  /* To push toggle (and everything to its right) to the right of the navbar */
  .s-header .navbar-collapse:not(.show) + :--navbar-toggle {
    margin-left: auto;
  }

  /* To layout the toggle content for a "mobile button" */
  .s-header :--navbar-toggle {
    /* WARNING: Do not set `display` outside of (--nav-compressed) */
    /* FAQ: The button as Bootstrap `.navbar-toggler` uses `display: none` */
    display: grid;
  }
  .s-header :--navbar-toggle--opened { @extend %x-mobile-button--only-icon; }
  .s-header :--navbar-toggle--closed { @extend %x-mobile-button--no-toggle; }
  .s-header :--navbar-toggle__icon   { @extend %x-mobile-button__icon; }
  .s-header :--navbar-toggle__text   { @extend %x-mobile-button__text; }
  /* AFTER GH-101: Remove this ruleset */
  .s-header :--navbar-toggle:not(.gh-101)::after {
    @extend %x-mobile-button__text;
  }



  /* Button */

  /* To layout the button */
  .s-header :--navbar-toggle {
    width: env(--header-navbar-toggle-width);
  }

  /* To style the button */
  .s-header :--navbar-toggle {
    padding: 0; /* to overwrite Bootstrap */

    /* To overwrite Bootstrap */
    border: none;
    border-radius: 0;
    background-color: env(--header-bkgd-color);
  }
  .s-header :--navbar-toggle:hover,
  .s-header :--navbar-toggle:active {
    background-color: env(--header-link-bkgd-color);
  }

  /* To isolate styles that require more specificity to override Portal */
  .s-header :--navbar-toggle,
  /* To overwrite Bootstrap (see "Portal & Docs Selectors") */
  :--for-docs .s-header :--navbar-toggle,
  :--for-portal .s-header :--navbar-toggle {
    color: env(--header-text-color);
  }



  /* Icon */

  /* To overwrite Bootstrap */
  .s-header :--navbar-toggle__icon { background-image: none !important; }
  /* To swap Bootstrap icon for Cortal icon */
  /* HACK: To apply icon styles without using a class in the markup */
  /* FAQ: For dynamic markup change, Portal & Docs markup must be updated */
  /* SEE: https://getbootstrap.com/docs/4.0/components/collapse/#events */
  .s-header :--navbar-toggle__icon {
    @extend [class*=" icon-"];
    @extend .icon;
  }
  /* To change icon without using dynamic icon classes */
  .s-header :--navbar-toggle--opened :--navbar-toggle__icon {
    @extend .icon-close;
  }
  .s-header :--navbar-toggle--closed :--navbar-toggle__icon {
    @extend .icon-burger;
  }
  /* To stretch icon to mimic icon in design */
  .s-header :--navbar-toggle--closed :--navbar-toggle__icon {
    transform: scaleX(1.5);
  }
  /* To overwrite `.icon` */
  .s-header :--navbar-toggle__icon {
    font-size: 30px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  }



  /* Text */

  .s-header :--navbar-toggle__text {
    line-height: 1.4; /* to overwrite Bootstrap *//* to match `body` */
  }

  /* To hide text of button when menu is open */
  .s-header :--navbar-toggle--opened :--navbar-toggle__text {
    display: none;
  }

  /* AFTER GH-101: Remove this block i.e. rely only on `[data-icon-label]` */
  /* To create fake text that does not exist in old markup */
  /* FAQ: The `:not(.gh-101)` applies style only to old markup */
  .s-header :--navbar-toggle:not(.gh-101)::after {
    content: 'Menu';
  }
  /* To hide fake text of button when menu is open */
  .s-header :--navbar-toggle--opened:not(.gh-101)::after {
    display: none;
  }

}





/* Navbar Collapsible   (Mobile-Only) */



/* Navbar Collapsible: Mobile */

@media (--nav-compressed) {

  /* To make the navbar act similar to an overlay menu */
  /* CAVEAT: If menu is open, and layout switches from collapsed to expanded to collapsed, then menu will remain open upon return to collapsed layout. */
  .s-header .navbar-collapse {
    /* Layout */
    @extend %s-header-mobile-menu;

    transition-duration: 0s; /* to overwrite Bootstrap */
  }

}





/* Nav */



/* Nav: Variables (Addendum) */

/* To reduce space between nav links when space is limited */
/* NOTE: This was designed by dev, but mimics Bootstrap behavior */
@media (--nav-expanded) and (--nav-wide-and-below)  {
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-cms` selector prefix */
  :--for-cms .s-header:not(.is-on-portal) {
    --nav-link-horz-pad: 1em;
  }
}
/* FAQ: Reduce space at wider breakpoint when Portal Nav is present */
@media (--nav-expanded) and (--nav-x-wide-and-below) {
  .s-header.is-on-portal,
  /* To apply style to old markup (see "Portal & Docs Selectors") */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-*` selectors */
  :--for-docs .s-header,
  :--for-portal .s-header {
    --nav-link-horz-pad: 1em;
  }
}

/* To increase space between nav links when space is available */
/* NOTE: This was designed by dev, but mimics Bootstrap behavior */
@media (--nav-expanded) and (--nav-wide-and-above) {
  /* To have 15px of space for 12px font */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-cms` selector prefix */
  :--for-cms .s-header:not(.is-on-portal) {
    --nav-link-horz-pad: 1.5em;
   }
}
/* FAQ: Increase space at wider breakpoint when Portal Nav is present */
@media (--nav-expanded) and (--nav-x-wide-and-above) {
  /* To have 15px of space for 12px font */
  .s-header.is-on-portal,
  /* To apply style to old markup (see "Portal & Docs Selectors") */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-*` selectors */
  :--for-docs .s-header,
  :--for-portal .s-header {
    --nav-link-horz-pad: 1.5em;
  }
}



/* Nav: Desktop */

@media (--nav-expanded) {

  /* To align text of CMS nav first link with text of Portal section header */
  .s-cms-nav {
    margin-left: calc( -1 * var(--nav-link-horz-pad) );
  }
  #header-logo {
    /* FAQ: Projects with wide logos may change this value to tweak alignment */
    --space-after-logo-before-nav: env(--header-navbar-normal-left-pad);

    /* To prevent zero-width element as it is loaded */
    /* FAQ: This only has effect on narrow-enough logos */
    /* NOTE: Do not use on mobile, because section header alignment would be
             moot if Portal were to even support mobile, because the section
             header position would change, because sidebar would be hidden */
    min-width: calc(203px - var(--space-after-logo-before-nav));

    /* To align logo (whole image not just visible pixels) w/ Portal side nav */
    margin-left: env(--header-navbar-normal-left-pad);
    /* To overwrite Bootstrap */
    margin-right: var(--space-after-logo-before-nav);
  }

  /* To align CMS nav to the right ONLY if there is no Portal */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-cms` selector prefix */
  :--for-cms .s-header:not(.is-on-portal) .s-cms-nav {
    margin-left: auto;
    margin-right: env(--header-navbar-normal-right-pad);
  }

}



/* Nav: Mobile */

@media (--nav-compressed) {

  /* To overwrite Bootstrap */
  /* To apply style to old markup (see "Portal & Docs Selectors") */
  /* TODO: 1. Remove `ml-auto` from Portal & Docs markup
           2. Remove this style */
  :--for-docs .s-header .s-cms-nav.ml-auto,
  :--for-portal .s-header .s-cms-nav.ml-auto {
    margin-left: 0 !important;
  }

  /* To match design */
  .s-cms-nav,
  .s-portal-nav .dropdown-menu {
    padding-top: 5px;
  }

  #header-logo {
    /* To align logo (whole image not just visible pixels) w/ Portal side nav */
    margin-left: env(--header-navbar-normal-left-pad);
  }

}





/* Nav Link */



/* Nav Link: Selectors */

/* RFE: Fix bug on the Internet so we can use these reliably */
/* SEE: https://github.com/postcss/postcss-custom-selectors/issues/40 */
/*
@custom-selector :--nav-link--hover  .nav-link:hover;
@custom-selector :--nav-link--focus  .nav-link:focus;
@custom-selector :--nav-link--active .nav-link:active;
@custom-selector :--nav-link--current
  .nav-item.active .nav-link,
  .nav-item.dropdown.show .nav-link;
*/
@custom-selector :--portal-nav-link
  .s-portal-nav .nav-link;
@custom-selector :--portal-button
  .s-portal-nav .dropdown:not(.show) .nav-link,
  .s-portal-nav .nav-item:not(.dropdown) .nav-link;
@custom-selector :--portal-button--user
  .s-portal-nav .dropdown:not(.show) .nav-link.dropdown-toggle;
@custom-selector :--portal-button--guest
  .s-portal-nav .nav-item:not(.dropdown) .nav-link:not(.dropdown-toggle);
@custom-selector :--portal-button__icon
  .s-portal-nav .dropdown:not(.show) .nav-link .icon,
  .s-portal-nav :not(.dropdown) .nav-link .icon;
@custom-selector :--portal-button__text
  .s-portal-nav .dropdown:not(.show) .nav-link .nav-text,
  .s-portal-nav :not(.dropdown) .nav-link .nav-text;
@custom-selector :--portal-message
  .s-portal-nav .dropdown.show .nav-link;
@custom-selector :--portal-message__icon
  .s-portal-nav .dropdown.show .nav-link .icon;
@custom-selector :--portal-message__text
  .s-portal-nav .dropdown.show .nav-link .nav-text;



/* Nav Link: General */

/* To layout the link */
.s-header .nav-link {
  /* To support truncation */
  display: flex;
  /* To vertically center text and icons (if any) */
  align-items: center;
}

/* Nav Link: General: Desktop */

@media (--nav-expanded) {
  .s-header .nav-link {
    height: 100%;
  }
}

/* Nav Link: General: Mobile */

@media (--nav-compressed) {
  .s-header .s-cms-nav .nav-link {
    font-size: 2em;
  }
}



/* Nav Link: Spacing */

/* FAQ: The `.navbar-nav` is to override Bootstrap specificity */
.s-header .navbar-nav .nav-link,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-portal .s-header .navbar-nav .nav-link {
  padding-right: var(--nav-link-horz-pad, 0);
  padding-left: var(--nav-link-horz-pad, 0);
}
.s-header .nav-link {
  padding-top: var(--nav-link-vert-pad);
  padding-bottom: var(--nav-link-vert-pad);
}



/* Nav Link: Portal */

.s-header :--portal-button {
  background-color: env(--header-portal-nav-bkgd-color);
}

/* Nav Link: Portal: Desktop */

@media (--nav-expanded) {

  .s-header :--portal-nav-link,
  /* To overwrite Bootstrap (see "Portal & Docs Selectors") */
  :--for-portal :--portal-nav-link {
    /* To match space between logo and left side of window */
    --nav-link-horz-pad: env(--header-navbar-normal-left-pad);
  }

  .s-header :--portal-nav-link {
    /* To horizontally center align icon, text, and toggle as a group */
    justify-content: center;

    /* To prevent expansion upon dropdown menu open */
    max-width: var(--portal-navlink-max-width);

    /* To prevent wrapping of this as it slides into place */
    /* NOTE: This affects username also, but it should not have any whitespace */
    white-space: nowrap;
  }

  /* CAVEAT: The selector must be specific enough to override Bootstrap */
  .s-header :--portal-nav-link,
  /* To overwrite Bootstrap (see "Portal & Docs Selectors") */
  :--for-portal .s-header :--portal-nav-link {
    padding-right: var(--nav-link-horz-pad, 0);
    padding-left: var(--nav-link-horz-pad, 0);
  }

  /* Icon */

  .s-header :--portal-nav-link__icon {
    margin-right: 0.5em;
  }

}

/* Nav Link: Portal: Mobile */

@media (--nav-compressed) {

  .s-header :--portal-nav-link/*,*//* ???: Is below selector necessary here? */
  /* To overwrite Bootstrap (see "Portal & Docs Selectors") */
  /* :--for-portal :--portal-nav-link */ {
    /* To match design */
    --nav-link-vert-pad: 0;
  }

  .s-header :--portal-button {
    width: fit-content;

    /* To avoid wrapping of button */
    /* FAQ: Wrap happens if logo is wide and button layout is not flexible */
    /* NOTE: The `clamp()` solution avoids using third media query for navbar */
    padding-right: clamp(
      var(--nav-link-horz-pad, 0),
      3vw,
      env(--header-navbar-mobile-right-pad)
    ); /* FAQ: The widths must prevent wrap when `#header-logo` is max. width */
    padding-left: var(--nav-link-horz-pad, 0);

    /* NOTE: This is for the edge case that username exceeds expectation */
    --nav-link-horz-pad: 12px;
  }

  /* Icon */

  /* To make link appear as a button when menu is closed */
  .s-header :--portal-button {
    display: grid;
  }
  .s-header :--portal-button--user   { @extend %x-mobile-button--has-toggle;}
  .s-header :--portal-button--guest  { @extend %x-mobile-button--no-toggle; }
  .s-header :--portal-button__icon   { @extend %x-mobile-button__icon; }
  .s-header :--portal-button__text   { @extend %x-mobile-button__text; }
  .s-header :--portal-button::after  { @extend %x-mobile-button__toggle; }
  /* AFTER GH-101: Remove this ruleset */
  .s-header :--portal-button:not(.gh-101)::before {
    @extend %x-mobile-button__text;
  }

  /* To make link appear as a welcome message when menu is open */
  .s-header :--portal-message__icon {
    margin-right: 0.875em; /* To approximate design via "pretty" `em` value */
  }
  .s-header :--portal-message__text {
    font-size: 18px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
    font-weight: var(--regular);
  }
  .s-header :--portal-message__text::before {
    content: 'Welcome, ';
  }
  .s-header :--portal-message::after {
    display: none;
  }

}



/* Nav Link: Separator */

/* Nav Link: Separator: Desktop */

@media (--nav-expanded) {
  .s-header .nav-item + .nav-item .nav-link {
    @extend %s-header-nav-link-border;
  }
}

/* Nav Link: Separator: Mobile */

@media (--nav-compressed) {
  .s-header .nav-item + .nav-item:not(.dropdown.show) .nav-link {
    @extend %s-header-nav-link-border;
  }
}



/* Nav Link: State */

/* To set color and override Bootstrap */
/* FAQ: The `.navbar-dark` would override Bootstrap specificity
        but Bootstrap is loaded after header code in Portal & Docs */
.s-header/*.navbar-dark*/ .nav-link,
.s-header/*.navbar-dark*/ .nav-link:focus,
.s-header/*.navbar-dark*/ .nav-link:hover {
  color: env(--header-text-color) !important; /* to override Bootstrap */
}

.s-header .nav-link:hover,
.s-header .nav-link:active,
.s-header .nav-item.active .nav-link {
  background-color: env(--header-link-bkgd-color);
}

/* Nav Link: State: Desktop */

@media (--nav-expanded) {
  .s-header .nav-item.dropdown.show .nav-link {
    background-color: env(--header-link-bkgd-color);
  }
  .s-header .s-cms-nav .nav-link:hover,
  .s-header .s-cms-nav .nav-link:focus,
  .s-header .s-cms-nav .nav-link:active,
  .s-header .s-cms-nav .nav-item.active .nav-link,
  .s-header .s-cms-nav .nav-item.dropdown.show .nav-link {
    border-top: env(--border-width--xx-thick) solid transparent;
    border-bottom: env(--border-width--xx-thick) solid env(--header-accent-color);
  }
}

/* Nav Link: State: Mobile */

/* FAQ: Design does not know what this should be yet */
/*
@media (--nav-compressed) {

}
*/



/* Nav Link: Text */

/* To truncate link text */
.s-header .nav-item { min-width: 0; }
.s-header .nav-text { @extend .x-truncate--one-line; }





/*
 * MENUS
 */





/* Dropdown */



/* Dropdown: Toggle */

.s-header .dropdown-toggle::after {
  @extend %x-arrow;

  --line: 0.1em; /* to get 1px at 12px text and 2px at 24px text */
  --color: env(--header-text-color);

  position: relative; /* to allow use of `top` (to vertically align) */
}

/* Dropdown: Toggle: Layout: Default */

.s-header .dropdown-toggle::after {
  --size: 0.375em;
  --nudge: 0.24em;

  margin-left: 0.6em;
}
.s-header .dropdown-toggle[aria-expanded="true"]::after {
  @extend %x-arrow--up;
  top: var(--nudge);
}
.s-header .dropdown-toggle[aria-expanded="false"]::after {
  @extend %x-arrow--down;
  bottom: var(--nudge);
}

/* Dropdown: Toggle: Layout: Mobile */

@media (--nav-compressed) {

  /* CMS Menu */

  .s-header .s-cms-nav .dropdown-toggle::after {
    --size: 0.2em;
    --nudge: 0.1em;
  }
  .s-header .s-cms-nav .dropdown-toggle[aria-expanded="true"]::after {
    @extend %x-arrow--left;
    margin-right: calc(-1 * var(--size)); /* to pull text closer */
    left: calc((-1 * var(--size) * 2) - var(--nudge)); /* to align arrow */
    order: -1; /* move to far left */
    top: auto; /* overwrite default */
  }
  .s-header .s-cms-nav .dropdown-toggle[aria-expanded="false"]::after {
    @extend %x-arrow--right;
    margin-left: auto;
    right: var(--nudge);
    /* order: 2; /* retain position */
    bottom: auto; /* overwrite default */
  }

}





/* Dropdown Menu */

.s-header .dropdown-menu {
  margin: unset; /* to undo Bootstrap */
  border-radius: unset; /* to undo Bootstrap */
}



/* Dropdown Menu: Desktop */

@media (--nav-expanded) {

  /* All Dropdowns */

  /* To overwrite Bootstrap */
  .s-header .dropdown-menu {
    padding: 7px 0 0;

    background-color: env(--header-link-bkgd-color);
    border: env(--border-width--normal) solid env(--header-accent-color);

    font-size: 12px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  }

  /* Portal Nav */

  .s-header .s-portal-nav .dropdown-menu {
    /* To stretch dropdown width to match the width of its parent */
    min-width: 100%;
  }

}



/* Dropdown Menu: Mobile */

@media (--nav-compressed) {

  /* CMS Menu & Portal Nav */

  /* To overwrite Bootstrap */
  .s-header .s-cms-nav .dropdown-menu {
    padding: 0 0 0.5em 0;
    margin: unset; /* to undo Bootstrap */

    background-color: transparent;
    border: none;

    font-size: 18px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  }
  .s-header .s-portal-nav .dropdown-menu {
    /* padding-top: unset; /* to undo Bootstrap *//* FAQ: Set elsewhere by us */
    padding-bottom: unset; /* to undo Bootstrap */

    background-color: transparent;
    border: none;

    font-size: 24px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  }

  /* CMS Nav */

  .s-header .s-cms-nav .dropdown-menu {
    @extend %s-header-nav-link-border;

    /* To allow `position: relative` to not move the menu */
    /* SEE: `_navbar.scss`
      .navbar-nav .dropdown-menu { position: static; float: none; } */
    top: 0;
  }

  /* Portal Nav */

  /* To make the navbar act similar to an overlay menu */
  /* CAVEAT: If menu is open, and layout switches from collapsed to expanded to collapsed, then menu will remain open upon return to collapsed layout. */
  .s-header .s-portal-nav .dropdown.show {
    /* Layout */
    @extend %s-header-mobile-menu;

    left: auto; /* to overwrite Bootstrap */
  }
  .s-header .s-portal-nav .dropdown.show .dropdown-menu {
    flex-grow: 1;
  }

  /* Nested Dropdown */

  /* To hide sibling dropdowns */
  /* CAVEAT: Relies on JavaScript specific to `s-cms-nav` (fallback: `â€¦ ~ â€¦` */
  .s-header .js-has-open-menu .dropdown:not(.show),
  /* CAVEAT: Does not hide previous siblings (solution: `js-has-open-menu`) */
  .s-header .nav-item.dropdown.show ~ .nav-item {
    display: none;
  }

  /* To provide a back button */
  .s-header .s-cms-nav .dropdown-toggle[aria-expanded="true"] {
    flex-wrap: wrap;
  }
  .s-header .s-cms-nav .dropdown-toggle[aria-expanded="true"]::after,
  .s-header .s-cms-nav .dropdown-toggle[aria-expanded="true"]::before {
    /* To approximate design */
    margin-bottom: 32px;
  }
  .s-header .s-cms-nav .dropdown-toggle[aria-expanded="true"]::before {
    content: 'All';
    flex-grow: 1;

    /* Style */
    font-size: 18px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  }
  .s-header .s-cms-nav .dropdown-toggle[aria-expanded="true"] .nav-text {
    flex-basis: 100%;
  }

}





/* Dropdown Item */



/* Dropdown Item: General */

.s-header .dropdown-item {
  border-left: env(--border-width--x-thick) solid transparent;

  font-weight: env(--bold);
}



/* Dropdown Item: Spacing */

.s-header .dropdown-item {
  --nav-link-vert-pad: 0.4em;

  /* To overwrite Bootstrap */
  padding: var(--nav-link-vert-pad) var(--menu-link-horz-pad, 0);
}



/* Dropdown Item: Separator */

/* To create line between each item */
.s-header .s-cms-nav .dropdown-item + .dropdown-item {
  @extend %s-header-menu-link-border;
}

/* Dropdown Item: Separator: Desktop */

@media (--nav-expanded) {
  .s-header .s-portal-nav .dropdown-item + .dropdown-item {
    @extend %s-header-menu-link-border;
  }
}

/* Dropdown Item: Separator: Mobile */

@media (--nav-compressed) {
  .s-header .s-portal-nav .dropdown-item + .dropdown-item {
    @extend %s-header-nav-link-border;
  }
}



/* Dropdown Item: State */

.s-header .dropdown-item.active,
.s-header .dropdown-item:active,
.s-header .dropdown-item:focus,
.s-header .dropdown-item:hover {
  border-left-color: env(--header-accent-color);
  background-color: env(--header-bkgd-color);
  box-shadow: none;
}

.s-header .dropdown-item,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header .dropdown-item,
:--for-docs .s-header .dropdown-item.active,
:--for-docs .s-header .dropdown-item:active,
:--for-docs .s-header .dropdown-item:focus,
:--for-docs .s-header .dropdown-item:hover,
:--for-portal .s-header .dropdown-item,
:--for-portal .s-header .dropdown-item.active,
:--for-portal .s-header .dropdown-item:active,
:--for-portal .s-header .dropdown-item:focus,
:--for-portal .s-header .dropdown-item:hover {
  color: env(--header-text-color);
}





/*
 * OTHER
 */





/* Search */



/* Search: Variables */

.s-header .s-search-bar {
  --button-horz-pad: 10px;
  --input-horz-pad: 0.125em;
}
@media (--nav-expanded) {
  .s-header .s-search-bar {
    --input-height: 26px;
    /* WARNING: Do not use `rem` until `html { 62.5%; }` */
    --button-font-size: 18px;
    --input-font-size: 14px;

    /* To match design */
    --space-after-search: 12px;

    /* To insert flexible space between search bar and CMS nav */
    --space-before-search: auto;
  }
}
@media (--nav-compressed) {
  .s-header .s-search-bar {
    --input-height: 45px;
    /* WARNING: Do not use `rem` until `html { 62.5%; }` */
    --button-font-size: 24px;
    --input-font-size: 18px;

    /* To match design */
    --space-after-search: 0;

    /* To let padding manage space */
    --space-before-search: 0;
  }
}



/* Search: Elements */

.s-header .s-search-bar {
  /* To remove all whitespace */
  /* NOTE: A `font-size: 0` is not necessary if tag whitespace is removed */
  font-size: 0;
}

.s-header .s-search-bar::part(form) {
  display: flex;
  align-items: center;

  position: relative;
}
.s-header .s-search-bar::part(button) {
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);

  box-sizing: content-box;
  height: var(--input-height);
  align-items: center; /* works if has flex layout (does if class is `.icon`) */

  margin: 0;
  padding: 0 var(--button-horz-pad);

  background-color: transparent;
  border: none;

  color: env(--header-text-color);
  font-size: var(--button-font-size);
}
.s-header .s-search-bar::part(input) {
  display: block;
  width: 100%;
  height: var(--input-height);

  margin: 0;
  padding-top: 0;
  padding-bottom: 0;
  /* To indent text by the width of embedded button plus actual padding */
  /* FAQ: Using `text-indent` has text overflow as user enters beyond width */
  /* HELP: Using `text-indent` is prefered (simpler)... how to do sans bug? */
  padding-left: calc(
    var(--button-horz-pad) +
    var(--button-font-size) +
    var(--button-horz-pad) +
    var(--input-horz-pad)
  );
  padding-right: var(--input-horz-pad);

  background-color: env(--header-search-bkgd-color);
  border: env(--border-width--normal) solid env(--header-search-brdr-color);
  border-radius: 5px;

  color: env(--header-text-color);
  font-size: var(--input-font-size);
}



/* Search: Spacing (Margin) */

/* Create space between search bar & portal nav ONLY IF both elements exist */
.s-header.is-on-portal .s-search-bar,
/* To apply style to old markup (see "Portal & Docs Selectors") */
  /* TODO: Hardcode `is-on-portal` in Portal & Docs markup,
           then remove the `:--for-*` selectors */
:--for-docs .s-header .s-search-bar,
:--for-portal .s-header .s-search-bar {
  margin-right: var(--space-after-search, 0);
}
/* Create space before search bar EVEN IF only search bar exists */
.s-header .s-search-bar {
  margin-left: var(--space-before-search, 0);
}
/* To apply style to old markup (see "Portal & Docs Selectors") */
:--for-docs .s-header .s-search-bar,
:--for-portal .s-header .s-search-bar {
  margin-left: var(--space-before-search, 0) !important;
}





/* Mobile Nav Top Row   (Search Bar & Portal Nav)   (Mobile-Only) */

@media (--nav-compressed) {

  /* To move portal nav & search bar to top of menu */
  .s-header .navbar-collapse:is(.show, .collapsing),
  .s-header .s-portal-nav .dropdown.show {
    display: flex;
    flex-direction: column;
  }
  .s-header .navbar-collapse:is(.show, .collapsing) .s-search-bar { order: -2; }
  .s-header :--portal-message { order: -1; }

  /* To create a bar at top of menu */
  .s-header .navbar-collapse:is(.show, .collapsing) .s-search-bar,
  .s-header :--portal-message {
    padding-left: var(--menu-link-horz-pad, 0);
    padding-right: var(--menu-link-horz-pad, 0);

    background-color: env(--header-bkgd-color);
  }

}





/* Icons */



.s-header .icon {
  /* HACK: The `!important` overrides Portal's temporary <style> CSS */
  /* AFTER GH-101: Portal: Remove `!important` */
  font-size: 26px !important;
}



/* Icons: Desktop */

@media (--nav-expanded) {

  /* To add space between icon and text for ALL icons */
  .s-header .icon {
    margin-right: 0.5em;
  }

}



/* Icons: Mobile */

@media (--nav-compressed) {

  /* To add space between icon and text for ONLY portal nav top-level and CMS */
  .s-header .s-portal-nav .dropdown-item .icon,
  .s-header .s-cms-nav .icon {
    display: none;
  }

}
