plugins:
  postcss-import:
    path:
      - './taccsite_cms/static/site_cms/css/src'
  postcss-extend: {}
  # Using `importFrom` via `postcss-preset-env` fails (but should work)
  # FAQ: So it is used directly with plugin (not via `postcss-preset-env`)
  # SEE: https://github.com/csstools/postcss-preset-env/issues/202
  # NOTE: Using `postcss-preset-env`'s install of `postcss-env-function` works
  postcss-env-function:
    importFrom:
      - './taccsite_cms/static/site_cms/css/src/_themes/export.js'
  postcss-preset-env:
    # SEE: https://github.com/csstools/postcss-preset-env#features
    stage: false
    # SEE: https://github.com/csstools/postcss-preset-env/blob/master/src/lib/plugins-by-id.js#L35
    features:
      custom-media-queries: true
      media-query-ranges: true
      not-pseudo-class: true
      nesting-rules: true
      # RFE: Fix bug on the Internet so we can use these reliably
      # SEE: https://github.com/postcss/postcss-custom-selectors/issues/40
      custom-selectors: true
  cssnano:
    preset:
      - 'default'
      -
        # Both of these are disabled to allow manual CSS build tests
        # The `discardDuplicates` is disabled to prevent hiding duplicate CSS
        discardDuplicates:
          exclude: true
        mergeRules:
          exclude: true
        # This breaks values like `clamp(0px, 15%, 48px)` by stripping 0's unit
        # SEE: https://github.com/cssnano/cssnano/issues/286
        convertValues:
          exclude: true
